# 📡 Pathfinder 초음파 센서 실시간 시스템

## 🎯 프로젝트 개요

패스파인더 키트의 HC-SR04 초음파 센서를 활용한 **실시간 거리 측정 및 데이터 시각화 시스템**입니다.

Flask SocketIO를 사용하여 실시간 WebSocket 통신으로 0ms 지연 측정 데이터를 제공하며, Chart.js를 활용한 아름다운 데이터 시각화를 지원합니다.

## ✨ 주요 기능

### 1. 📊 기본 측정 기능
- **실시간 거리 측정**: 100ms 간격으로 연속 측정
- **정확도 표시**: 2cm ~ 400cm 범위 내 ±1cm 정확도
- **최소/최대/평균값**: 자동 통계 계산
- **측정 성공률**: 오류율 실시간 모니터링

### 2. 📈 데이터 시각화
- **실시간 그래프**: Chart.js 기반 부드러운 라인 차트
- **히스토그램**: 최근 20개 측정값 실시간 표시
- **측정 로그**: 최대 100개 데이터 저장
- **통계 대시보드**: 시각적 통계 카드

### 3. 🎮 인터랙티브 제어
- **원클릭 시작/중지**: 간편한 측정 제어
- **센서 테스트**: 5회 연속 측정으로 센서 상태 확인
- **데이터 초기화**: 모든 측정 데이터 리셋
- **실시간 상태 표시**: 측정 중 시각적 피드백

## 🔧 하드웨어 연결

```
HC-SR04 초음파 센서 → Raspberry Pi Zero 2 W
VCC  → 5V
GND  → GND
TRIG → GPIO5 (핀 29)
ECHO → GPIO6 (핀 31)
```

## 📦 필요한 패키지

```bash
# 시스템 패키지
sudo apt update
sudo apt install python3-pip

# Python 패키지
pip install flask flask-socketio RPi.GPIO
```

## 🚀 실행 방법

### 1. 기본 실행
```bash
cd 2.ComponentClass/_2.SonicClass/
python3 app.py
```

### 2. 백그라운드 실행
```bash
nohup python3 app.py &
```

### 3. 웹 브라우저 접속
```
http://라즈베리파이IP:5000
```

## 🎯 사용법

### 기본 조작
1. **측정 시작**: `▶️ 측정 시작` 버튼 클릭
2. **측정 중지**: `⏹️ 측정 중지` 버튼 클릭
3. **센서 테스트**: `🔧 센서 테스트` 버튼으로 센서 상태 확인
4. **데이터 초기화**: `🧹 데이터 초기화` 버튼으로 모든 데이터 리셋

### 실시간 정보
- **거리 표시**: 큰 숫자로 현재 거리 표시
- **상태 바**: 0-400cm 범위를 시각적으로 표시
- **측정 상태**: 가까움/보통/멀음 자동 분류
- **연결 상태**: WebSocket 연결 상태 실시간 표시

### 통계 정보
- **최소 거리**: 측정된 최소값
- **최대 거리**: 측정된 최대값
- **평균 거리**: 최근 측정값들의 평균
- **총 측정 횟수**: 성공한 측정 횟수
- **오류 횟수**: 실패한 측정 횟수
- **성공률**: 전체 측정 대비 성공률

## 📊 데이터 시각화

### 실시간 차트
- **라인 차트**: 시간에 따른 거리 변화
- **부드러운 애니메이션**: 0ms 지연 실시간 업데이트
- **자동 스케일링**: 0-400cm 범위 자동 조정
- **최근 20개 데이터**: 메모리 효율적 표시

### 시각적 요소
- **거리 바**: 그라데이션 색상으로 거리 표시
- **측정 인디케이터**: 측정 중 깜빡이는 LED 효과
- **상태 카드**: 통계 정보를 카드 형태로 표시
- **실시간 로그**: 모든 이벤트 실시간 기록

## 🔍 문제 해결

### 센서 연결 확인
```bash
# GPIO 상태 확인
gpio readall

# 센서 테스트 (단독 실행)
python3 ../../../1.ComponentTest/sonic_test.py
```

### 일반적인 문제들

#### 1. 측정값이 불안정한 경우
- **원인**: 센서 주변 장애물, 전원 불안정
- **해결**: 센서 앞 50cm 이상 공간 확보, 전원 연결 확인

#### 2. 연결이 안 되는 경우
- **원인**: GPIO 핀 연결 오류, 권한 문제
- **해결**: 배선 재확인, `sudo` 권한으로 실행

#### 3. 웹 페이지가 로드되지 않는 경우
- **원인**: 방화벽, IP 주소 오류
- **해결**: `hostname -I`로 IP 확인, 5000 포트 개방

#### 4. 측정이 시작되지 않는 경우
- **원인**: GPIO 초기화 실패, 다른 프로세스 사용 중
- **해결**: 라즈베리파이 재부팅, 다른 GPIO 프로그램 종료

## 🎮 고급 기능

### API 엔드포인트
- `GET /`: 메인 웹 인터페이스
- `WebSocket /socket.io/`: 실시간 데이터 통신

### WebSocket 이벤트
- `start_measurement`: 측정 시작
- `stop_measurement`: 측정 중지
- `test_sensor`: 센서 테스트
- `clear_data`: 데이터 초기화
- `measurement_data`: 실시간 측정 데이터
- `debug_message`: 디버그 메시지

### 설정 변경
```python
# app.py에서 수정 가능한 설정들
MEASUREMENT_INTERVAL = 0.1  # 측정 간격 (초)
TIMEOUT = 0.1              # 센서 타임아웃 (초)
measurement_data.maxlen = 100  # 저장할 최대 데이터 개수
```

## 🔄 확장 아이디어

### 추가 기능 구현
1. **알림 시스템**: 특정 거리 도달 시 알림
2. **데이터 내보내기**: CSV/JSON 형태로 데이터 저장
3. **다중 센서**: 여러 센서 동시 모니터링
4. **음성 피드백**: 거리에 따른 음성 안내
5. **모바일 앱**: 스마트폰 전용 인터페이스

### 교육적 활용
1. **물리 실험**: 음속 측정 실험
2. **수학 학습**: 통계 및 그래프 이해
3. **프로그래밍**: WebSocket 통신 학습
4. **IoT 프로젝트**: 실시간 데이터 처리 학습

## 📝 라이선스

이 프로젝트는 교육용으로 제작되었으며, MIT 라이선스를 따릅니다.

## 🤝 기여하기

버그 리포트나 기능 제안은 GitHub Issues를 통해 제출해 주세요.

---

**🎓 패스파인더 AI 파이썬 자율주행 키트**  
*단계별 학습으로 완성하는 라즈베리파이 로봇* 